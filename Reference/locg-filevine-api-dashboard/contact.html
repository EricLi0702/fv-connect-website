<!DOCTYPE html>
<html>

<head>
  <title>LOCG-Filevine API -- Multi-Create Contacts Tool</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" type="text/css">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <link rel="stylesheet" href="//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">

  <!-- Custom styles for this template -->
  <link href="/css/api-style.css" rel="stylesheet" type="text/css">

  <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js" type="text/javascript"></script>
  <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
  <script src="js/contact.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <a href="index.html"><img src="img/Logo.png" alt="LOCG Logo"></a>
                <div class="clear" style="margin-top:15px;"></div>
                <button class="return"><a href="/index.html">Return to Dashboard</a></button>
            </div><!-- logo -->
            <div class="title">
                <h1>Multi-Create Contacts Tool</h1>
                <p>The tool below allows us to upload multiple contacts at once using queue calls to the <a href="https://filevine-api.api-docs.io/v2/contacts/create-contact" target="_blank">Create Contacts</a> endpoint on the Filevine API.</p>
            </div><!-- title -->
        </div><!-- header -->
        
		<h3>Step 1: Download and fill in the following CSV templates</h3>
			<p>
				<b>Multi-Create Contacts Template:</b> Add one contact to each row to be created. The only required columns are name; all the rest of the columns are optional. If you add labels or personType, be sure to enter the text exactly as it appears in Filevine with no typos. <a href="/templates/Multi-Create%20Contacts.csv" download>Download</a><br>
				<b>Add Person Types:</b> Add one contact to each row and identify the "Person Type" you want to add (the text must exactly match Filevine Person Types with no typos). Keep in mind this does not remove existing person types, only adds a new one. <a href="/templates/Add%20Person%20Types.csv" download>Download</a>
			</p>
		<h3>Step 2: Upload the completed file, and execute your action button</h3>
			<p>
				If you are uploading the file for the first time, you can just click "Upload". If a file with the same name has been previously uploaded during the same session, you will need to choose the box to replace the file. Once you receive upload success message, execute the action. Please give the system plenty of time to work - refreshing or closing the page before you receive success messages will end the process.</p>
		<form id="fileToUploadForm" method="post" enctype="multipart/form-data" style="margin-top:50px;">
            <input type="file" name="fileToUpload" id="fileToUpload">
            <input type="checkbox" name="removeOriginalFile" value="onn">Replace the Original File
            <input type="submit" value="Upload" name="submit">
        </form>
        
        <div class="col-md-12 row" style="margin-top:30px;">
            <input type="hidden" id="uploaded_file" data-val="" style="display:none;">
            <button id="addContactsBtn" style="margin-right:50px;">Add Contacts</button>    
            <button id="addPersonTypesBtn">Add PersonTypes</button>    
        </div>
        
        <hr style="margin-bottom: 50px;">
        <div id="preview"></div><br>
        <div id="err"></div>
    </div>
</body>
</html>
